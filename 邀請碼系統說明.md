# 邀請碼系統說明

## 系統概述
邀請碼系統允許玩家透過輸入8位英數字邀請碼來兌換星星，支援100、300、500、1000顆星星四種面額。

## 功能特點

### 1. 邀請碼格式
- 8位英數字組合（大寫字母 + 數字）
- 自動轉換為大寫
- 支援Enter鍵快速兌換

### 2. 面額種類
- **100顆星星**：20組邀請碼
- **300顆星星**：15組邀請碼  
- **500顆星星**：10組邀請碼
- **1000顆星星**：5組邀請碼

### 3. 安全機制
- 單次使用：每個邀請碼只能兌換一次
- 使用記錄：記錄兌換時間和使用者
- 本地儲存：已使用的邀請碼記錄在localStorage

## 檔案結構

### 主要檔案
- `shop.html` - 商城頁面，包含邀請碼兌換介面
- `js/inviteCodes.json` - 邀請碼資料庫
- `generate_invite_codes.js` - 邀請碼產生腳本（需要Node.js）

### 邀請碼資料格式
```json
{
  "code": "ABC12345",
  "stars": 100,
  "used": false,
  "usedAt": null,
  "usedBy": null,
  "createdAt": "2024-12-19T10:00:00.000Z"
}
```

## 使用流程

### 1. 玩家兌換流程
1. 進入商城頁面，選擇「邀請碼兌換」標籤
2. 在輸入框中輸入8位邀請碼
3. 點擊「兌換」按鈕或按Enter鍵
4. 系統驗證邀請碼有效性
5. 兌換成功後自動發放星星並更新顯示

### 2. 管理員操作流程
1. 修改 `generate_invite_codes.js` 中的配置
2. 執行 `node generate_invite_codes.js` 產生新邀請碼
3. 將產生的 `js/inviteCodes.json` 部署到網站

## 技術實現

### 前端驗證
- 格式檢查：8位英數字
- 存在性檢查：邀請碼是否在資料庫中
- 使用狀態檢查：是否已被兌換

### 資料儲存
- 邀請碼資料：`js/inviteCodes.json`
- 使用記錄：`localStorage.usedInviteCodes`
- 星星數量：`localStorage.totalStars`

### 使用者體驗
- 即時驗證和錯誤提示
- 成功/失敗狀態視覺回饋
- 音效和動畫效果
- 響應式設計

## 擴展功能

### 可選功能
1. **使用期限**：為邀請碼設定過期時間
2. **使用次數限制**：允許同一邀請碼多次使用
3. **用戶追蹤**：記錄具體使用者資訊
4. **統計報表**：兌換統計和使用分析

### 安全增強
1. **伺服器驗證**：將驗證邏輯移至後端
2. **加密儲存**：對邀請碼進行加密
3. **API限制**：防止暴力破解

## 注意事項

1. **資料備份**：定期備份邀請碼資料
2. **使用監控**：監控異常兌換行為
3. **定期更新**：定期產生新的邀請碼
4. **測試驗證**：部署前充分測試兌換流程

## 故障排除

### 常見問題
1. **邀請碼載入失敗**：檢查 `js/inviteCodes.json` 檔案路徑
2. **兌換無效**：確認邀請碼格式和存在性
3. **星星未增加**：檢查localStorage權限和StarRewardSystem

### 除錯方法
1. 開啟瀏覽器開發者工具
2. 查看Console錯誤訊息
3. 檢查Network請求狀態
4. 驗證localStorage資料 