<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>éŠæˆ²å ´æ™¯ - Typing Hero</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="responsive.css">
  <style>
    /* ====== å…¨åŸŸæ¨£å¼ ====== */
    body {
      margin: 0;
      font-family: 'Orbitron', sans-serif;
      background: url('https://wallpaperaccess.com/full/192936.jpg') no-repeat center center fixed;
      background-size: cover;
      color: #fff;
      text-align: center;
      overflow-y: auto;
    }

    header {
      background: rgba(10, 20, 40, 0.85);
      padding: 16px 32px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 0 24px 8px #00ffff88, 0 0 40px 0 #a259ff33 inset;
      border-bottom: 2px solid #00ffff;
      backdrop-filter: blur(4px);
      position: relative;
      z-index: 10;
    }

    header h1 {
      margin: 0;
      font-size: 2.1rem;
      color: #00ffff;
      letter-spacing: 2px;
      text-shadow: 0 0 12px #00ffff, 0 0 32px #a259ff;
    }

    .btn {
      background: linear-gradient(90deg, #00ffff 0%, #a259ff 100%);
      color: #000;
      border: none;
      padding: 10px 22px;
      border-radius: 12px;
      cursor: pointer;
      font-weight: bold;
      box-shadow: 0 0 16px #00ffff, 0 0 24px #a259ff99;
      margin-left: 8px;
      font-size: 1.1rem;
      letter-spacing: 1px;
      transition: transform 0.15s, box-shadow 0.15s;
    }

    .btn:hover {
      transform: scale(1.07);
      box-shadow: 0 0 32px #00ffff, 0 0 48px #a259ffcc;
    }

    /* ====== å ´æ™¯é¸æ“‡å€åŸŸ ====== */
    .scenario-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 24px;
      padding: 32px 20px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .scenario-card {
      background: rgba(10, 20, 40, 0.85);
      border: 2px solid #00ffff;
      border-radius: 16px;
      padding: 24px;
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(8px);
    }

    .scenario-card::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: linear-gradient(45deg, transparent 30%, rgba(0, 255, 255, 0.1) 50%, transparent 70%);
      transform: translateX(-100%);
      transition: transform 0.6s ease;
    }

    .scenario-card:hover::before {
      transform: translateX(100%);
    }

    .scenario-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 0 32px #00ffff, 0 0 48px #a259ffcc;
      border-color: #a259ff;
    }

    .scenario-icon {
      font-size: 3rem;
      margin-bottom: 16px;
      display: block;
    }

    .scenario-title {
      font-size: 1.5rem;
      color: #00ffff;
      margin-bottom: 12px;
      text-shadow: 0 0 8px #00ffff;
    }

    .scenario-desc {
      color: #ccc;
      line-height: 1.6;
      margin-bottom: 16px;
    }

    .scenario-stats {
      display: flex;
      justify-content: space-between;
      font-size: 0.9rem;
      color: #ffd700;
    }

    /* ====== æ”¶é›†æŒ‘æˆ°å ´æ™¯ ====== */
    .collection-challenge {
      border-color: #00ffff;
    }

    .collection-challenge .scenario-icon {
      color: #00ffff;
    }

    /* ====== ç¨€æœ‰åº¦è¿½æ±‚å ´æ™¯ ====== */
    .rarity-hunt {
      border-color: #ffd700;
    }

    .rarity-hunt .scenario-icon {
      color: #ffd700;
    }

    /* ====== æˆå°±è§£é–å ´æ™¯ ====== */
    .achievement-unlock {
      border-color: #a259ff;
    }

    .achievement-unlock .scenario-icon {
      color: #a259ff;
    }

    /* ====== ç¤¾äº¤å ´æ™¯ ====== */
    .social-scenario {
      border-color: #ff6b6b;
    }

    .social-scenario .scenario-icon {
      color: #ff6b6b;
    }

    /* ====== é€²åº¦æ¢æ¨£å¼ ====== */
    .progress-bar {
      width: 100%;
      height: 8px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
      overflow: hidden;
      margin: 8px 0;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #00ffff 0%, #a259ff 100%);
      border-radius: 4px;
      transition: width 0.3s ease;
    }

    /* ====== é€šçŸ¥ç³»çµ± ====== */
    .notification {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(10, 20, 40, 0.95);
      border: 2px solid #00ffff;
      border-radius: 12px;
      padding: 16px 24px;
      color: #fff;
      font-weight: bold;
      z-index: 10000;
      animation: slideDown 0.3s ease-out;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    @keyframes slideDown {
      from { transform: translateX(-50%) translateY(-100%); opacity: 0; }
      to { transform: translateX(-50%) translateY(0); opacity: 1; }
    }

    /* ====== æ˜Ÿç©ºèƒŒæ™¯å‹•ç•« ====== */
    .stars-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
    }

    .star {
      position: absolute;
      background: #fff;
      border-radius: 50%;
      animation: twinkle 3s infinite;
    }

    @keyframes twinkle {
      0%, 100% { opacity: 0.3; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.2); }
    }
  </style>
</head>
<body>
  <!-- æ˜Ÿç©ºèƒŒæ™¯ -->
  <div class="stars-bg" id="starsBg"></div>

  <header>
    <h1>ğŸ® éŠæˆ²å ´æ™¯</h1>
    <div>
      <button class="btn" onclick="location.href='index.html'">ğŸ  é¦–é </button>
      <button class="btn" onclick="location.href='cards.html'">ğŸ“ å¡ç‰‡æ”¶è—</button>
      <button class="btn" onclick="location.href='gacha.html'">ğŸ´ æŠ½å¡</button>
      <button class="btn" onclick="location.href='social_share.html'">ğŸ‘¥ ç¤¾äº¤</button>
      <button class="btn" onclick="location.href='visual_enhancement.html'">âœ¨ è¦–è¦º</button>
    </div>
  </header>

  <div class="scenario-grid">
    <!-- æ”¶é›†æŒ‘æˆ°å ´æ™¯ -->
    <div class="scenario-card collection-challenge" onclick="enterCollectionChallenge()">
      <span class="scenario-icon">ğŸ¯</span>
      <div class="scenario-title">æ”¶é›†æŒ‘æˆ°</div>
      <div class="scenario-desc">
        åŠªåŠ›æ”¶é›†æ‰€æœ‰å¡ç‰‡ï¼Œå®Œæˆä½ çš„æ”¶è—å¤¢æƒ³ï¼æŒ‘æˆ°ä¸åŒçš„æ”¶é›†ç›®æ¨™ï¼Œç²å¾—è±åšçå‹µã€‚
      </div>
      <div class="progress-bar">
        <div class="progress-fill" id="collectionProgress" style="width: 0%"></div>
      </div>
      <div class="scenario-stats">
        <span>å·²æ”¶é›†: <span id="collectedCount">0</span>/<span id="totalCount">0</span></span>
        <span>å®Œæˆåº¦: <span id="collectionPercent">0</span>%</span>
      </div>
    </div>

    <!-- ç¨€æœ‰åº¦è¿½æ±‚å ´æ™¯ -->
    <div class="scenario-card rarity-hunt" onclick="enterRarityHunt()">
      <span class="scenario-icon">â­</span>
      <div class="scenario-title">ç¨€æœ‰åº¦è¿½æ±‚</div>
      <div class="scenario-desc">
        ç‰¹åˆ¥è¿½æ±‚è¶…ç¨€æœ‰å¡ç‰‡ï¼ŒæŒ‘æˆ°æ¥µé™æ”¶é›†ï¼SSRå¡ç‰‡ç­‰ä½ ä¾†æ”¶é›†ï¼Œå±•ç¾ä½ çš„é‹æ°£èˆ‡å¯¦åŠ›ã€‚
      </div>
      <div class="progress-bar">
        <div class="progress-fill" id="rarityProgress" style="width: 0%"></div>
      </div>
      <div class="scenario-stats">
        <span>SSR: <span id="ssrCount">0</span>/<span id="ssrTotal">0</span></span>
        <span>ç¨€æœ‰åº¦: <span id="rarityPercent">0</span>%</span>
      </div>
    </div>

    <!-- æˆå°±è§£é–å ´æ™¯ -->
    <div class="scenario-card achievement-unlock" onclick="enterAchievementUnlock()">
      <span class="scenario-icon">ğŸ†</span>
      <div class="scenario-title">æˆå°±è§£é–</div>
      <div class="scenario-desc">
        å®Œæˆå„ç¨®æ”¶é›†æˆå°±ï¼Œç²å¾—æ¦®è­½èˆ‡çå‹µï¼æŒ‘æˆ°è‡ªæˆ‘ï¼Œè§£é–æ›´å¤šæˆå°±å¾½ç« ã€‚
      </div>
      <div class="progress-bar">
        <div class="progress-fill" id="achievementProgress" style="width: 0%"></div>
      </div>
      <div class="scenario-stats">
        <span>æˆå°±: <span id="achievementCount">0</span>/<span id="achievementTotal">5</span></span>
        <span>å®Œæˆåº¦: <span id="achievementPercent">0</span>%</span>
      </div>
    </div>

    <!-- ç¤¾äº¤å ´æ™¯ -->
    <div class="scenario-card social-scenario" onclick="enterSocialScenario()">
      <span class="scenario-icon">ğŸ‘¥</span>
      <div class="scenario-title">ç¤¾äº¤åˆ†äº«</div>
      <div class="scenario-desc">
        èˆ‡æœ‹å‹åˆ†äº«ä½ çš„æ”¶é›†æˆæœï¼Œæ¯”è¼ƒé€²åº¦ï¼Œè¨è«–å¡ç‰‡è¨­è¨ˆï¼å»ºç«‹ä½ çš„æ”¶è—ç¤¾ç¾¤ã€‚
      </div>
      <div class="progress-bar">
        <div class="progress-fill" id="socialProgress" style="width: 0%"></div>
      </div>
      <div class="scenario-stats">
        <span>åˆ†äº«æ¬¡æ•¸: <span id="shareCount">0</span></span>
        <span>ç¤¾ç¾¤ç­‰ç´š: <span id="socialLevel">æ–°æ‰‹</span></span>
      </div>
    </div>
  </div>

  <script src="js/sound.js"></script>
  <script src="js/userData.js"></script>
  <script src="cards.js"></script>
  <script>
    // è¼‰å…¥å¡ç‰‡æ•¸æ“š
    let allCards = window.allCards || [];
    let ownedCards = JSON.parse(localStorage.getItem('ownedCards') || '{}');
    let shards = JSON.parse(localStorage.getItem('cardShards') || '{}');
    let achievementData = JSON.parse(localStorage.getItem('achievement_rewards') || '{}');
    let socialData = JSON.parse(localStorage.getItem('social_data') || '{}');

    // åˆå§‹åŒ–æ˜Ÿç©ºèƒŒæ™¯
    function initStars() {
      const starsBg = document.getElementById('starsBg');
      const starCount = 100;

      for (let i = 0; i < starCount; i++) {
        const star = document.createElement('div');
        star.className = 'star';
        star.style.left = Math.random() * 100 + '%';
        star.style.top = Math.random() * 100 + '%';
        star.style.width = Math.random() * 3 + 1 + 'px';
        star.style.height = star.style.width;
        star.style.animationDelay = Math.random() * 3 + 's';
        star.style.animationDuration = (Math.random() * 2 + 2) + 's';
        starsBg.appendChild(star);
      }
    }

    // æ›´æ–°æ”¶é›†æŒ‘æˆ°çµ±è¨ˆ
    function updateCollectionStats() {
      const totalCards = allCards.length;
      const collectedCount = Object.keys(ownedCards).length;
      const percent = totalCards > 0 ? Math.round((collectedCount / totalCards) * 100) : 0;

      document.getElementById('collectedCount').textContent = collectedCount;
      document.getElementById('totalCount').textContent = totalCards;
      document.getElementById('collectionPercent').textContent = percent;
      document.getElementById('collectionProgress').style.width = percent + '%';
    }

    // æ›´æ–°ç¨€æœ‰åº¦è¿½æ±‚çµ±è¨ˆ
    function updateRarityStats() {
      const ssrCards = allCards.filter(card => card.rarity === 'è¶…ç¨€æœ‰');
      const collectedSSR = ssrCards.filter(card => ownedCards[card.word]).length;
      const percent = ssrCards.length > 0 ? Math.round((collectedSSR / ssrCards.length) * 100) : 0;

      document.getElementById('ssrCount').textContent = collectedSSR;
      document.getElementById('ssrTotal').textContent = ssrCards.length;
      document.getElementById('rarityPercent').textContent = percent;
      document.getElementById('rarityProgress').style.width = percent + '%';
    }

    // æ›´æ–°æˆå°±çµ±è¨ˆ
    function updateAchievementStats() {
      const achievements = [
        'first_card', 'ten_cards', 'twenty_cards', 'fifty_cards', 'hundred_cards'
      ];
      const completedCount = achievements.filter(id => achievementData[id]).length;
      const percent = Math.round((completedCount / achievements.length) * 100);

      document.getElementById('achievementCount').textContent = completedCount;
      document.getElementById('achievementPercent').textContent = percent;
      document.getElementById('achievementProgress').style.width = percent + '%';
    }

    // æ›´æ–°ç¤¾äº¤çµ±è¨ˆ
    function updateSocialStats() {
      const shareCount = socialData.shareCount || 0;
      const socialLevel = getSocialLevel(shareCount);

      document.getElementById('shareCount').textContent = shareCount;
      document.getElementById('socialLevel').textContent = socialLevel;
      document.getElementById('socialProgress').style.width = Math.min(shareCount * 10, 100) + '%';
    }

    // ç²å–ç¤¾äº¤ç­‰ç´š
    function getSocialLevel(shareCount) {
      if (shareCount >= 50) return 'å‚³å¥‡';
      if (shareCount >= 30) return 'å¤§å¸«';
      if (shareCount >= 20) return 'å°ˆå®¶';
      if (shareCount >= 10) return 'ç†Ÿç·´';
      if (shareCount >= 5) return 'é€²éš';
      return 'æ–°æ‰‹';
    }

    // é¡¯ç¤ºé€šçŸ¥
    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      notification.className = 'notification';
      notification.textContent = message;
      
      if (type === 'success') {
        notification.style.borderColor = '#4caf50';
      } else if (type === 'warning') {
        notification.style.borderColor = '#ff9800';
      }
      
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.remove();
      }, 3000);
    }

    // é€²å…¥æ”¶é›†æŒ‘æˆ°å ´æ™¯
    function enterCollectionChallenge() {
      const collectedCount = Object.keys(ownedCards).length;
      const totalCards = allCards.length;
      
      if (collectedCount === totalCards) {
        showNotification('ğŸ‰ æ­å–œï¼ä½ å·²ç¶“æ”¶é›†å®Œæ‰€æœ‰å¡ç‰‡ï¼', 'success');
      } else {
        showNotification(`ğŸ“Š æ”¶é›†é€²åº¦ï¼š${collectedCount}/${totalCards}ï¼Œç¹¼çºŒåŠ æ²¹ï¼`, 'info');
        setTimeout(() => {
          location.href = 'cards.html';
        }, 1500);
      }
    }

    // é€²å…¥ç¨€æœ‰åº¦è¿½æ±‚å ´æ™¯
    function enterRarityHunt() {
      const ssrCards = allCards.filter(card => card.rarity === 'è¶…ç¨€æœ‰');
      const collectedSSR = ssrCards.filter(card => ownedCards[card.word]).length;
      
      if (collectedSSR === ssrCards.length) {
        showNotification('ğŸŒŸ å¤ªå²å®³äº†ï¼ä½ å·²ç¶“æ”¶é›†å®Œæ‰€æœ‰SSRå¡ç‰‡ï¼', 'success');
      } else {
        showNotification(`â­ SSRæ”¶é›†ï¼š${collectedSSR}/${ssrCards.length}ï¼ŒæŒ‘æˆ°æ¥µé™ï¼`, 'info');
        setTimeout(() => {
          location.href = 'gacha.html';
        }, 1500);
      }
    }

    // é€²å…¥æˆå°±è§£é–å ´æ™¯
    function enterAchievementUnlock() {
      const achievements = [
        { id: 'first_card', title: 'åˆæ¬¡æ”¶é›†', desc: 'è§£é–ç¬¬ä¸€å¼µå¡ç‰‡' },
        { id: 'ten_cards', title: 'æ”¶è—å®¶', desc: 'è§£é–10å¼µå¡ç‰‡' },
        { id: 'twenty_cards', title: 'å¡ç‰‡å¤§å¸«', desc: 'è§£é–20å¼µå¡ç‰‡' },
        { id: 'fifty_cards', title: 'å¡ç‰‡å°ˆå®¶', desc: 'è§£é–50å¼µå¡ç‰‡' },
        { id: 'hundred_cards', title: 'å¡ç‰‡å‚³å¥‡', desc: 'è§£é–100å¼µå¡ç‰‡' }
      ];
      
      const completedAchievements = achievements.filter(a => achievementData[a.id]);
      const nextAchievement = achievements.find(a => !achievementData[a.id]);
      
      if (nextAchievement) {
        showNotification(`ğŸ† ä¸‹ä¸€å€‹æˆå°±ï¼š${nextAchievement.title} - ${nextAchievement.desc}`, 'info');
      } else {
        showNotification('ğŸŠ æ­å–œï¼ä½ å·²ç¶“å®Œæˆæ‰€æœ‰æˆå°±ï¼', 'success');
      }
    }

    // é€²å…¥ç¤¾äº¤å ´æ™¯
    function enterSocialScenario() {
      const shareCount = socialData.shareCount || 0;
      const socialLevel = getSocialLevel(shareCount);
      
      showNotification(`ğŸ‘¥ ç¤¾äº¤ç­‰ç´šï¼š${socialLevel}ï¼Œåˆ†äº«æ¬¡æ•¸ï¼š${shareCount}`, 'info');
      
      // æ¨¡æ“¬åˆ†äº«åŠŸèƒ½
      setTimeout(() => {
        const newShareCount = shareCount + 1;
        socialData.shareCount = newShareCount;
        localStorage.setItem('social_data', JSON.stringify(socialData));
        updateSocialStats();
        showNotification('ğŸ“¤ åˆ†äº«æˆåŠŸï¼ç²å¾—ç¤¾äº¤ç¶“é©—ï¼', 'success');
      }, 2000);
    }

    // é é¢è¼‰å…¥æ™‚åˆå§‹åŒ–
    window.addEventListener('load', () => {
      // æª¢æŸ¥æˆå°±ç³»çµ±
      checkAchievements();
      
      // åˆå§‹åŒ–éŸ³æ•ˆç³»çµ±
      if (typeof SoundSystem !== 'undefined') {
        SoundSystem.init();
      }
      
      // åˆå§‹åŒ–æ˜Ÿç©ºèƒŒæ™¯
      initStars();
      
      // æ›´æ–°æ‰€æœ‰çµ±è¨ˆ
      updateCollectionStats();
      updateRarityStats();
      updateAchievementStats();
      updateSocialStats();
      
      // é¡¯ç¤ºæ­¡è¿è¨Šæ¯
      setTimeout(() => {
        showNotification('ğŸ® æ­¡è¿ä¾†åˆ°éŠæˆ²å ´æ™¯ï¼é¸æ“‡ä½ å–œæ­¡çš„æŒ‘æˆ°ï¼', 'info');
      }, 1000);
    });
  </script>
</body>
</html> 