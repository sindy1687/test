<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>填空挑戰 - 英打小英雄</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="responsive_enhanced.css">
  <style>
    body {
      margin:0; font-family:'Segoe UI',Arial,sans-serif,'Orbitron',sans-serif;
      background: linear-gradient(135deg, #232526 0%, #414345 100%);
      color:#fff; text-align:center; padding:20px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    h1 {
      color:#ffd700; text-shadow:0 0 8px #ffd700;
      margin-bottom:20px; letter-spacing:2px;
      font-family:'Orbitron',Arial,sans-serif;
      font-size:2.2rem;
    }
    .top-btns {
      position:absolute; top:16px; left:16px; display:flex; gap:8px;
    }
    .top-btns button {
      padding:6px 12px; font-size:1rem;
      background:#ffd700; color:#000;
      border:none; border-radius:12px;
      cursor:pointer; box-shadow:0 0 6px rgba(255,215,0,0.2);
      font-family:'Orbitron',Arial,sans-serif;
      transition: background 0.2s;
    }
    .top-btns button:hover { background:#ffe54f; }
    #star-counter {
      display:flex; align-items:center; justify-content:center; gap:18px;
      background:rgba(30,30,40,0.92); border-radius:18px;
      box-shadow:0 4px 18px 0 rgba(31,38,135,0.18);
      padding:14px 32px; margin-bottom:18px;
      border:1.5px solid #ffd70044;
      font-size:1.18rem; color:#ffd700;
      min-width:260px;
      font-family:'Orbitron',Arial,sans-serif;
    }
    #timer {
      font-size:1.1rem; margin-bottom:16px;
    }
    #timer.hidden { display:none; }
    #question-container {
      background:rgba(30,30,40,0.97);
      border-radius:22px; box-shadow:0 8px 32px rgba(31,38,135,0.37);
      padding:38px 30px 30px;
      max-width:440px; width:100%; margin:auto;
      border:1.5px solid #ffd70044;
      display:flex; flex-direction:column; align-items:center;
      margin-bottom: 18px;
    }
    .question-title {
      font-size:1.1rem; margin-bottom:8px; letter-spacing:1px;
    }
    .question-sentence {
      font-size:1.7rem; font-weight:bold; margin:10px 0 20px 0; line-height:1.5; word-break:break-word;
    }
    .question-sentence .blank {
      color:#0ff; background:#fff2; border-radius:8px; padding:2px 16px; box-shadow:0 1px 4px #0ff2;
    }
    .question-zh {
      color:#ffd700; margin-bottom:16px; font-size:1.08rem;
    }
    input {
      width:92%; padding:15px; font-size:1.15rem;
      border:2px solid #ffd700; border-radius:14px;
      background:#222; color:#fff; margin-bottom:22px;
      box-shadow:0 2px 8px #0003;
      outline:none; transition:border 0.2s;
    }
    input:focus { border-color:#0ff; }
    .btn-row {
      display:flex; justify-content:center; gap:20px;
      margin-bottom:14px; width:100%;
    }
    button {
      font-size:1rem; padding:10px 26px;
      border:none; border-radius:12px;
      cursor:pointer; transition:background 0.2s;
      box-shadow:0 2px 8px #0002;
      font-family:'Orbitron',Arial,sans-serif;
    }
    #submit-btn { background:#ffd700; color:#111; }
    #submit-btn:disabled { background:#ccc; color:#888; cursor:not-allowed; }
    #skip-btn { background:#bbb; color:#222; }
    #skip-btn:hover { background:#ccc; }
    #speak-btn { background:#0ff; color:#111; margin-top:10px; }
    #speak-btn:disabled { background:#555; color:#888; }
    #speak-btn:hover { background:#7ff; }
    #next-btn { background:#4caf50; color:#fff; margin-top:10px; }
    #next-btn:hover { background:#6fdc7f; }
    #feedback { margin-top:12px; font-size:1.13rem; min-height:28px; }
    .complete-anim {
      animation:pop 0.7s cubic-bezier(.68,-0.55,.27,1.55) both;
    }
    @keyframes pop {
      0% { transform:scale(0.7); opacity:0; }
      60% { transform:scale(1.15); opacity:1; }
      100% { transform:scale(1); }
    }
    @media (max-width:600px) {
      #question-container, #star-counter { max-width:98vw; padding:18px 4vw; }
      .question-sentence { font-size:1.15rem; }
      input { font-size:1rem; }
      button { font-size:0.98rem; padding:8px 12px; }
    }
    /* 統一星星顯示區塊樣式（與 index.html/poseidon.html 一致） */
    #starsDisplay {
      position: fixed;
      top: 20px;
      left: 20px;
      background: rgba(10, 20, 40, 0.85);
      padding: 8px 14px;
      border-radius: 10px;
      color: #ffd700;
      font-weight: bold;
      box-shadow: 0 0 12px #ffd700, 0 0 32px #00ffff;
      border: 2px solid #00ffff;
      font-size: 1.2rem;
      z-index: 10;
    }
    .top-btns {
      position: fixed;
      top: 20px;
      right: 20px;
      left: auto;
      display: flex;
      gap: 8px;
      z-index: 11;
    }
    /* 反饋動畫樣式 */
    .feedback-box {
      display: inline-block;
      padding: 10px 22px;
      border-radius: 16px;
      font-size: 1.18rem;
      font-weight: bold;
      box-shadow: 0 2px 16px #0004;
      margin-top: 8px;
      transition: background 0.3s, color 0.3s, transform 0.2s;
      animation: popfade 0.7s cubic-bezier(.68,-0.55,.27,1.55);
    }
    .feedback-correct { background: linear-gradient(90deg,#2ecc40,#bfff00); color:#222; }
    .feedback-wrong { background: linear-gradient(90deg,#ff4f4f,#ffbaba); color:#fff; }
    .feedback-bonus { color:#ffd700; animation: bonusflash 1s infinite alternate; font-size:1.25em; }
    @keyframes popfade { 0%{transform:scale(0.7);opacity:0;} 60%{transform:scale(1.15);opacity:1;} 100%{transform:scale(1);} }
    @keyframes bonusflash { 0%{text-shadow:0 0 8px #ffd700;} 100%{text-shadow:0 0 24px #fff700;} }

    /* ===== 遊戲結束畫面樣式 ===== */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      backdrop-filter: blur(4px);
    }

    .modal-content {
      background: rgba(30, 30, 40, 0.95);
      border: 2px solid #ffd700;
      border-radius: 20px;
      padding: 40px;
      text-align: center;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 0 32px #ffd70044, 0 0 80px #00ffff22 inset;
      animation: modalPop 0.5s cubic-bezier(.68, -0.55, .27, 1.55);
    }

    .end-icon {
      font-size: 4rem;
      margin-bottom: 20px;
      animation: tada 1.2s infinite;
    }

    .modal-content h2 {
      color: #ffd700;
      font-size: 2rem;
      margin-bottom: 25px;
      text-shadow: 0 0 12px #ffd700;
      font-family: 'Orbitron', Arial, sans-serif;
    }

    .end-stats {
      margin-bottom: 30px;
    }

    .end-stats p {
      font-size: 1.2rem;
      margin: 10px 0;
      color: #fff;
    }

    .end-stats span {
      color: #ffd700;
      font-weight: bold;
    }

    .end-buttons {
      display: flex;
      gap: 15px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .end-buttons button {
      background: linear-gradient(90deg, #ffd700, #ffed4e);
      color: #000;
      border: none;
      border-radius: 12px;
      padding: 12px 24px;
      font-size: 1.1rem;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      font-family: 'Orbitron', Arial, sans-serif;
    }

    .end-buttons button:hover {
      transform: scale(1.05);
      box-shadow: 0 0 16px #ffd700;
    }

    @keyframes modalPop {
      0% {
        transform: scale(0.7);
        opacity: 0;
      }
      60% {
        transform: scale(1.1);
        opacity: 1;
      }
      100% {
        transform: scale(1);
      }
    }

    @keyframes tada {
      0% { transform: scale(1); }
      10%, 20% { transform: scale(0.9) rotate(-3deg); }
      30%, 50%, 70%, 90% { transform: scale(1.1) rotate(3deg); }
      40%, 60%, 80% { transform: scale(1.1) rotate(-3deg); }
      100% { transform: scale(1) rotate(0); }
    }

    /* ===== 響應式設計優化 ===== */
    @media (max-width: 768px) {
      .top-btns {
        position: fixed;
        top: 10px;
        right: 10px;
        left: auto;
        display: flex;
        gap: 6px;
        z-index: 11;
        flex-wrap: wrap;
        justify-content: flex-end;
      }
      
      .top-btns button {
        padding: 4px 8px;
        font-size: 0.9rem;
      }
      
      #starsDisplay {
        top: 10px;
        left: 10px;
        padding: 6px 10px;
        font-size: 1rem;
      }
      
      h1 {
        font-size: 1.8rem;
        margin-top: 60px;
      }
      
      #question-container {
        max-width: 95vw;
        padding: 20px 15px;
        margin: 10px auto;
      }
      
      .question-sentence {
        font-size: 1.3rem;
      }
      
      .modal-content {
        padding: 20px;
        margin: 10px;
        max-width: 95vw;
      }
      
      .end-buttons {
        flex-direction: column;
        gap: 10px;
      }
      
      .end-buttons button {
        width: 100%;
        padding: 10px;
      }
    }

    @media (max-width: 480px) {
      body {
        padding: 10px;
      }
      
      .top-btns {
        position: relative;
        top: auto;
        right: auto;
        left: auto;
        justify-content: center;
        margin-bottom: 15px;
      }
      
      #starsDisplay {
        position: relative;
        top: auto;
        left: auto;
        display: inline-block;
        margin-bottom: 10px;
      }
      
      h1 {
        font-size: 1.5rem;
        margin-top: 10px;
      }
      
      #star-counter {
        font-size: 1rem;
        padding: 10px 20px;
        min-width: 200px;
      }
      
      .question-sentence {
        font-size: 1.1rem;
      }
      
      input {
        font-size: 1rem;
        padding: 12px;
      }
      
      .btn-row {
        flex-direction: column;
        gap: 10px;
      }
      
      .btn-row button {
        width: 100%;
        padding: 12px;
      }
    }

    /* ===== 背景音樂控制按鈕樣式 ===== */
    #bgMusicControl {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: rgba(255, 215, 0, 0.9);
      color: #000;
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      font-size: 1.5rem;
      cursor: pointer;
      z-index: 12;
      box-shadow: 0 0 12px rgba(255, 215, 0, 0.4);
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #bgMusicControl:hover {
      background: rgba(255, 215, 0, 1);
      transform: scale(1.1);
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
    }

    #bgMusicControl.paused {
      background: rgba(255, 255, 255, 0.3);
      color: #fff;
    }

    #bgMusicControl.paused:hover {
      background: rgba(255, 255, 255, 0.5);
    }
  </style>
</head>
<body>
  <!-- 背景音樂控制按鈕 -->
  <button id="bgMusicControl" onclick="toggleBackgroundMusic()" title="背景音樂控制">🎵</button>

  <!-- 左上角星星數顯示區塊 -->
  <div id="starsDisplay">
    ⭐<span id="totalStarsCount">0</span>
  </div>
  <div class="top-btns">
    <button onclick="location.href='atlas.html?tab=greek'" aria-label="回首頁">🏠 回首頁</button>
    <button onclick="resetProgress()" aria-label="重新開始">🔄 重新開始</button>
    <button onclick="showReviewModal()" aria-label="複習單字">📚 複習單字</button>
  </div>
  <h1>赫拉 Hera - 填空挑戰</h1>
  <div id="star-counter">第 <span id="current-index">0</span> / <span id="total-questions">0</span> 題</div>
  <div id="timer" class="hidden">⏳ 倒數：<span id="time-left">0</span> 秒</div>
  <div id="question-container"></div>

  <!-- 遊戲結束畫面 -->
  <div id="gameEndModal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="end-icon">🎉</div>
      <h2>遊戲完成！</h2>
      <div class="end-stats">
        <p>⭐ 本次獲得星星：<span id="endSessionStars">0</span></p>
        <p>✅ 答對題數：<span id="endCorrectCount">0</span></p>
        <p>❌ 答錯題數：<span id="endWrongCount">0</span></p>
        <p>⭐ 累積總星星：<span id="endTotalStars">0</span></p>
      </div>
      <div class="end-buttons">
        <button onclick="restartGame()">🔄 重新開始</button>
        <button onclick="location.href='atlas.html?tab=greek'">🏠 返回首頁</button>
      </div>
    </div>
  </div>

  <!-- 複習單字彈窗 -->
  <div id="reviewModal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="end-icon">📚</div>
      <h2>單字複習</h2>
      
      <!-- 分類選擇器 -->
      <div style="margin-bottom: 20px;">
        <label for="categoryFilter" style="color: #ffd700; font-weight: bold; margin-right: 10px;">選擇分類：</label>
        <select id="categoryFilter" style="
          background: #222;
          color: #fff;
          border: 2px solid #ffd700;
          border-radius: 8px;
          padding: 8px 12px;
          font-size: 1rem;
          cursor: pointer;
        ">
          <option value="all">全部單字</option>
          <option value="連接詞介系詞">連接詞介系詞</option>
          <option value="食物飲料">食物飲料</option>
          <option value="動作動詞">動作動詞</option>
          <option value="序數詞">序數詞</option>
          <option value="金錢相關">金錢相關</option>
          <option value="節日慶祝">節日慶祝</option>
          <option value="抽象概念">抽象概念</option>
          <option value="邏輯關係">邏輯關係</option>
          <option value="日常生活用品">日常生活用品</option>
          <option value="個人衛生">個人衛生</option>
          <option value="動物">動物</option>
          <option value="商業場所">商業場所</option>
          <option value="形容詞">形容詞</option>
          <option value="時間頻率">時間頻率</option>
          <option value="需求表達">需求表達</option>
          <option value="結束完成">結束完成</option>
          <option value="金錢交易">金錢交易</option>
          <option value="動作操作">動作操作</option>
          <option value="情感表達">情感表達</option>
          <option value="商業活動">商業活動</option>
          <option value="附加表達">附加表達</option>
          <option value="頻率表達">頻率表達</option>
        </select>
      </div>
      
      <!-- 統計資訊 -->
      <div id="vocabStats" style="
        background: rgba(255, 215, 0, 0.1);
        border: 1px solid #ffd700;
        border-radius: 8px;
        padding: 10px;
        margin-bottom: 15px;
        color: #ffd700;
        font-size: 0.9rem;
      ">
        總共 <span id="totalVocabCount">0</span> 個單字
        <button onclick="showVocabStats()" style="
          background: #0ff;
          color: #000;
          border: none;
          border-radius: 6px;
          padding: 4px 8px;
          font-size: 0.8rem;
          margin-left: 10px;
          cursor: pointer;
        ">📊 詳細統計</button>
        <button onclick="exportVocabData()" style="
          background: #4caf50;
          color: #fff;
          border: none;
          border-radius: 6px;
          padding: 4px 8px;
          font-size: 0.8rem;
          margin-left: 5px;
          cursor: pointer;
        ">📥 匯出字庫</button>
      </div>
      
      <div id="reviewWordsContainer" style="max-height: 400px; overflow-y: auto; margin: 20px 0;">
        <!-- 單字列表將在這裡動態生成 -->
      </div>
      <div class="end-buttons">
        <button onclick="closeReviewModal()">關閉</button>
      </div>
    </div>
  </div>

  <script src="js/gameDialogue.js"></script>
  <script>
    const rawData = [
      {
    "word": "or",
    "zh": "或者；否則",
    "en_sentence": "Do you want tea or juice?",
    "zh_sentence": "你要茶或者果汁？",
    "category": "連接詞介系詞"
  },
  {
    "word": "off",
    "zh": "脫下；離去",
    "en_sentence": "Take off your shoes at the door.",
    "zh_sentence": "在門口把鞋子脫下。",
    "category": "動作動詞"
  },
  {
    "word": "noodle",
    "zh": "麵條",
    "en_sentence": "I like noodle with soup.",
    "zh_sentence": "我喜歡加湯的麵條。",
    "category": "食物飲料"
  },
  {
    "word": "chocolate",
    "zh": "巧克力",
    "en_sentence": "Chocolate melts in your mouth.",
    "zh_sentence": "巧克力在嘴裡融化。",
    "category": "食物飲料"
  },
  {
    "word": "shake",
    "zh": "搖動",
    "en_sentence": "Please shake the bottle before drinking.",
    "zh_sentence": "喝之前請搖動瓶子。",
    "category": "動作動詞"
  },
  {
    "word": "sugar",
    "zh": "糖",
    "en_sentence": "Add sugar to your tea if you like it sweet.",
    "zh_sentence": "如果你喜歡甜的，就在茶裡加糖。",
    "category": "食物飲料"
  },
  {
    "word": "meal",
    "zh": "餐",
    "en_sentence": "We eat three meals a day.",
    "zh_sentence": "我們一天吃三餐。",
    "category": "食物飲料"
  },
  {
    "word": "bottle",
    "zh": "瓶子",
    "en_sentence": "Bring a water bottle to gym class.",
    "zh_sentence": "去體育課時帶一個水瓶。",
    "category": "日常生活用品"
  },
  {
    "word": "plate",
    "zh": "盤子",
    "en_sentence": "Please put the cake on a plate.",
    "zh_sentence": "請把蛋糕放到盤子上。",
    "category": "日常生活用品"
  },
  {
    "word": "pick",
    "zh": "撿起",
    "en_sentence": "Pick up the trash in the yard.",
    "zh_sentence": "把院子裡的垃圾撿起來。",
    "category": "動作動詞"
  },
  {
    "word": "mean",
    "zh": "吝嗇的；意指",
    "en_sentence": "What do you mean by that?",
    "zh_sentence": "你那樣說是什麼意思？",
    "category": "形容詞"
  },
  {
    "word": "first",
    "zh": "第一(的)",
    "en_sentence": "She came in first in the race.",
    "zh_sentence": "她在比賽中獲得第一名。",
    "category": "序數詞"
  },
  {
    "word": "second",
    "zh": "第二(的)",
    "en_sentence": "He finished second in the contest.",
    "zh_sentence": "他在比賽中拿到第二名。",
    "category": "序數詞"
  },
  {
    "word": "third",
    "zh": "第三(的)",
    "en_sentence": "I got the third slice of pizza.",
    "zh_sentence": "我拿到了第三片披薩。",
    "category": "序數詞"
  },
  {
    "word": "money",
    "zh": "錢",
    "en_sentence": "He saved his money to buy a toy.",
    "zh_sentence": "他存錢想買一個玩具。",
    "category": "金錢相關"
  },
  {
    "word": "Mother's Day",
    "zh": "母親節",
    "en_sentence": "We give flowers on Mother's Day.",
    "zh_sentence": "我們在母親節送花。",
    "category": "節日慶祝"
  },
  {
    "word": "idea",
    "zh": "主意；點子",
    "en_sentence": "I have an idea for a new game.",
    "zh_sentence": "我有一個新遊戲的點子。",
    "category": "抽象概念"
  },
  {
    "word": "because",
    "zh": "因為",
    "en_sentence": "I am happy because I passed the test.",
    "zh_sentence": "因為我考試及格，所以很開心。",
    "category": "邏輯關係"
  },
  {
    "word": "drawer",
    "zh": "抽屜",
    "en_sentence": "The toy is in the drawer.",
    "zh_sentence": "玩具在抽屜裡。",
    "category": "日常生活用品"
  },
  {
    "word": "bath",
    "zh": "澡",
    "en_sentence": "I take a bath every night.",
    "zh_sentence": "我每天晚上洗澡。",
    "category": "個人衛生"
  },
  {
    "word": "cow",
    "zh": "母牛",
    "en_sentence": "A cow eats grass in the field.",
    "zh_sentence": "母牛在田裡吃草。",
    "category": "動物"
  },
  {
    "word": "market",
    "zh": "市場",
    "en_sentence": "We go to the market on Sunday.",
    "zh_sentence": "我們星期天去市場。",
    "category": "商業場所"
  },
  {
    "word": "expensive",
    "zh": "昂貴的",
    "en_sentence": "That toy is too expensive.",
    "zh_sentence": "那個玩具太昂貴了。",
    "category": "形容詞"
  },
  {
    "word": "cheap",
    "zh": "便宜的",
    "en_sentence": "These shoes are very cheap.",
    "zh_sentence": "這雙鞋子很便宜。",
    "category": "形容詞"
  },
  {
    "word": "enough",
    "zh": "足夠的",
    "en_sentence": "Do we have enough chairs?",
    "zh_sentence": "我們有足夠的椅子嗎？",
    "category": "形容詞"
  },
  {
    "word": "all",
    "zh": "全部的；整個的",
    "en_sentence": "All students must bring their books.",
    "zh_sentence": "所有學生都必須帶書來。",
    "category": "形容詞"
  },
  {
    "word": "poor",
    "zh": "可憐的；貧窮的；不佳的",
    "en_sentence": "The poor puppy needs food.",
    "zh_sentence": "那隻可憐的小狗需要食物。",
    "category": "形容詞"
  },
  {
    "word": "early",
    "zh": "早的；早地",
    "en_sentence": "We wake up early every morning.",
    "zh_sentence": "我們每天早上很早就起床。",
    "category": "時間頻率"
  },
  {
    "word": "dirty",
    "zh": "髒的",
    "en_sentence": "Your shirt is dirty; please wash it.",
    "zh_sentence": "你的襯衫很髒，請去洗。",
    "category": "形容詞"
  },
  {
    "word": "easy",
    "zh": "容易的",
    "en_sentence": "This question is easy to answer.",
    "zh_sentence": "這個問題很容易回答。",
    "category": "形容詞"
  },
  {
    "word": "hard",
    "zh": "艱難的；硬的",
    "en_sentence": "The test was hard for me.",
    "zh_sentence": "對我來說，考試很艱難。",
    "category": "形容詞"
  },
  {
    "word": "busy",
    "zh": "忙碌的",
    "en_sentence": "Mom is busy cooking dinner.",
    "zh_sentence": "媽媽正忙著做晚餐。",
    "category": "形容詞"
  },
  {
    "word": "free",
    "zh": "空閒的；免費的",
    "en_sentence": "This game is free to play.",
    "zh_sentence": "這個遊戲可以免費玩。",
    "category": "形容詞"
  },
  {
    "word": "need",
    "zh": "需要",
    "en_sentence": "I need a pencil to write.",
    "zh_sentence": "我需要一支鉛筆來寫字。",
    "category": "需求表達"
  },
  {
    "word": "end",
    "zh": "結束",
    "en_sentence": "The movie will end soon.",
    "zh_sentence": "電影很快就要結束了。",
    "category": "結束完成"
  },
  {
    "word": "cost",
    "zh": "花費",
    "en_sentence": "How much does it cost?",
    "zh_sentence": "這要花費多少錢？",
    "category": "金錢交易"
  },
  {
    "word": "buy",
    "zh": "購買",
    "en_sentence": "I will buy a gift for my friend.",
    "zh_sentence": "我會為我的朋友買一份禮物。",
    "category": "金錢交易"
  },
  {
    "word": "put",
    "zh": "放置",
    "en_sentence": "Put your bag on the desk.",
    "zh_sentence": "把你的書包放在桌上。",
    "category": "動作操作"
  },
  {
    "word": "feed",
    "zh": "餵養",
    "en_sentence": "Feed the cat every morning.",
    "zh_sentence": "每天早上餵那隻貓。",
    "category": "動作操作"
  },
  {
    "word": "hate",
    "zh": "討厭",
    "en_sentence": "I hate doing chores on weekends.",
    "zh_sentence": "我討厭週末做家務。",
    "category": "情感表達"
  },
  {
    "word": "sell",
    "zh": "賣",
    "en_sentence": "They sell fresh vegetables at the market.",
    "zh_sentence": "他們在市場賣新鮮蔬菜。",
    "category": "商業活動"
  },
  {
    "word": "also",
    "zh": "也",
    "en_sentence": "I like ice cream, and I also like cake.",
    "zh_sentence": "我喜歡冰淇淋，也喜歡蛋糕。",
    "category": "附加表達"
  },
  {
    "word": "once",
    "zh": "一次",
    "en_sentence": "I went there only once last year.",
    "zh_sentence": "我去年只去過那裡一次。",
    "category": "頻率表達"
  }
    ];

    const QUESTIONS_COUNT = 20;
    const TIME_LIMIT = 30;
    let data, currentIndex, attemptCount, answered;
    let timerInterval;
    let preferredVoice = null;
    let answerLog = [];
    let sessionStars = 0;

    // 音效資源
    const correctSound = new Audio('audio/correct.mp3');
    const wrongSound = new Audio('audio/wrong.mp3');
    const typeSound = new Audio('audio/type.mp3');

    // ===== 背景音樂控制 =====
    let bgMusic = null;
    let isMusicPlaying = false;

    function initBackgroundMusic() {
      bgMusic = new Audio('sound/午後放鬆時光（純音樂）.mp3');
      bgMusic.loop = true;
      bgMusic.volume = 0.3;
      
      // 從localStorage讀取音樂狀態
      const musicState = localStorage.getItem('bgMusicState');
      if (musicState === 'playing') {
        playBackgroundMusic();
      }
    }

    function toggleBackgroundMusic() {
      if (isMusicPlaying) {
        pauseBackgroundMusic();
      } else {
        playBackgroundMusic();
      }
    }

    function playBackgroundMusic() {
      if (bgMusic) {
        bgMusic.play().then(() => {
          isMusicPlaying = true;
          document.getElementById('bgMusicControl').textContent = '🔊';
          document.getElementById('bgMusicControl').classList.remove('paused');
          localStorage.setItem('bgMusicState', 'playing');
        }).catch(err => {
          console.log('背景音樂播放失敗:', err);
        });
      }
    }

    function pauseBackgroundMusic() {
      if (bgMusic) {
        bgMusic.pause();
        isMusicPlaying = false;
        document.getElementById('bgMusicControl').textContent = '🔇';
        document.getElementById('bgMusicControl').classList.add('paused');
        localStorage.setItem('bgMusicState', 'paused');
      }
    }

    function escapeRegExp(s){return s.replace(/[.*+?^${}()|[\\]\\]/g,'\\$&');}
    function getRandomQuestions(arr,n){const c=Math.min(n,arr.length);return arr.slice().sort(()=>Math.random()-0.5).slice(0,c);}    
    function initData(){
      const selected = getRandomQuestions(rawData, QUESTIONS_COUNT);
      data = selected.map(item=>({
        answer:item.word, zh:item.zh,
        sentence:item.en_sentence.replace(new RegExp(escapeRegExp(item.word),'i'),'___'),
        original:item.en_sentence,
        category: item.category
      }));
      document.getElementById('total-questions').textContent = data.length;
    }

    function saveProgress(){
      localStorage.setItem('fillIndex', currentIndex);
    }

    function loadProgress(){
      currentIndex = parseInt(localStorage.getItem('fillIndex')) || 0;
      if (typeof data !== 'undefined' && Array.isArray(data) && currentIndex >= data.length) {
        currentIndex = 0;
        localStorage.removeItem('fillIndex');
      }
    }

    function resetProgress(){
      localStorage.removeItem('fillIndex');
      location.reload();
    }

    function updateCounter(){
      document.getElementById('current-index').textContent = currentIndex+1;
    }

    function startTimer(){
      clearInterval(timerInterval);
      let t=TIME_LIMIT;
      document.getElementById('time-left').textContent = t;
      document.getElementById('timer').classList.remove('hidden');
      timerInterval = setInterval(()=>{
        t--;
        document.getElementById('time-left').textContent = t;
        if(t<=0){
          clearInterval(timerInterval);
          revealAnswer(true);
        }
      },1000);
    }

    function stopTimer(){ clearInterval(timerInterval); }

    function pickVoice() {
      const voices = window.speechSynthesis.getVoices();
      const prefer = [
        'Google US English', 'Microsoft Aria Online', 'Microsoft Jenny Online', 'Samantha', 'Jenny', 'Aria', 'en-US'
      ];
      preferredVoice = voices.find(v => prefer.some(p => v.name.includes(p))) || voices.find(v => v.lang === 'en-US') || voices[0];
    }
    if (typeof speechSynthesis !== 'undefined') {
      speechSynthesis.onvoiceschanged = pickVoice;
      pickVoice();
    }

    function speak(text, rate = 1.0, callback) {
      if (!window.speechSynthesis) return;
      const utter = new window.SpeechSynthesisUtterance(text);
      utter.lang = 'en-US';
      utter.rate = rate;
      utter.pitch = 1.12;
      if (preferredVoice) utter.voice = preferredVoice;
      if (callback) utter.onend = callback;
      window.speechSynthesis.cancel();
      window.speechSynthesis.speak(utter);
    }

    function speakQuestionAndWord(q) {
      window.speechSynthesis.cancel();
      speak(q.original, 0.97, function() {
        setTimeout(() => speak(q.original.replace(new RegExp(escapeRegExp(q.answer), 'i'), '...'), 1.02, function() {
          setTimeout(() => speak(q.answer, 1.08), 350);
        }), 350);
      });
    }

    function revealAnswer(autoNext=false){
      attemptCount = Infinity;
      document.getElementById('feedback').innerHTML = `<span style='color:#f66;'>⏰ 時間到！正確答案：<b>${data[currentIndex].answer}</b></span>`;
      document.getElementById('submit-btn').disabled=true;
      document.getElementById('user-input').disabled=true;
      answerLog[currentIndex] = {
        word: data[currentIndex].answer,
        zh: data[currentIndex].zh_sentence ? data[currentIndex].zh_sentence : data[currentIndex].zh,
        en: data[currentIndex].original,
        user: document.getElementById('user-input')?.value || '',
        correct: false,
        stars: 0
      };
      if(autoNext) setTimeout(()=>{ currentIndex++; showQuestion(); }, 500);
    }

    function checkAnswer(){
      if(answered) return;
      attemptCount++;
      const ui = document.getElementById('user-input');
      const feedback = document.getElementById('feedback');
      const ans=data[currentIndex].answer.toLowerCase();
      if(ui.value.trim().toLowerCase()===ans){
        answered=true; stopTimer();
        // 計算作答時間
        const usedSeconds = (Date.now() - (window.answerStartTime || Date.now())) / 1000;
        let bonus = 0;
        let feedbackMsg = `<div class='feedback-box feedback-correct'>✅ 答對了！太棒了！`;
        if (usedSeconds < 10) {
          bonus = 2;
          feedbackMsg += ` <span class='feedback-bonus'>BONUS! ⏱️ +2</span>`;
        }
        feedbackMsg += `</div>`;
        feedback.innerHTML = feedbackMsg;
        ui.disabled = true;
        document.getElementById('submit-btn').disabled = true;
        speak(ans,1.1);
        saveProgress(); updateCounter();
        answerLog[currentIndex] = {
          word: data[currentIndex].answer,
          zh: data[currentIndex].zh_sentence ? data[currentIndex].zh_sentence : data[currentIndex].zh,
          en: data[currentIndex].original,
          user: ui.value.trim(),
          correct: true,
          stars: 0
        };
        let stars = loadTotalStars();
        let addStars = 1 + bonus;
        stars += addStars;
        localStorage.setItem('totalStars', stars);
        updateStarsDisplay();
        sessionStars += addStars;
        document.getElementById('totalStarsCount').textContent = stars;
        try { correctSound.currentTime = 0; correctSound.play(); } catch(e){}
        setTimeout(()=>{ currentIndex++; showQuestion(); }, 1300);
        showCorrectAnswerDialogue();
      } else {
        if(attemptCount < 3) {
          feedback.innerHTML = `<div class='feedback-box feedback-wrong'>❌ 再試一次！你可以的！</div>`;
          try { wrongSound.currentTime = 0; wrongSound.play(); } catch(e){}
        } else {
          feedback.innerHTML = `<div class='feedback-box feedback-wrong'>❌ 正確答案：<b>${data[currentIndex].answer}</b><br>別氣餒，再接再厲！</div>`;
          ui.disabled = true;
          document.getElementById('submit-btn').disabled = true;
          answerLog[currentIndex] = {
            word: data[currentIndex].answer,
            zh: data[currentIndex].zh_sentence ? data[currentIndex].zh_sentence : data[currentIndex].zh,
            en: data[currentIndex].original,
            user: ui.value.trim(),
            correct: false,
            stars: 0
          };
          try { wrongSound.currentTime = 0; wrongSound.play(); } catch(e){}
          setTimeout(()=>{ currentIndex++; showQuestion(); }, 1300);
          showWrongAnswerDialogue();
        }
      }
    }

    function showQuestion(){
      if(!data || !Array.isArray(data) || data.length === 0) {
        document.getElementById('question-container').innerHTML = '<div style="color:#f66;font-size:1.2rem;">⚠️ 題庫沒有題目，請檢查資料！</div>';
        return;
      }
      if(currentIndex < 0 || currentIndex >= data.length) {
        // 遊戲結束，顯示結束畫面
        showGameEndScreen();
        return;
      }
      answered=false; attemptCount=0;
      const q=data[currentIndex];
      document.getElementById('question-container').innerHTML = `
        <div class="question-title">英文句子：</div>
        <div class="question-sentence">${q.sentence.replace('___','<span class=\'blank\'>___</span>')}</div>
        <div class="question-zh">中文提示：${q.zh_sentence ? q.zh_sentence : q.zh}</div>
        <input id="user-input" placeholder="輸入答案…" autocomplete="off" />
        <div class="btn-row">
          <button id="submit-btn" onclick="checkAnswer()">送出</button>
          <button id="skip-btn" onclick="skipQuestion()">跳過</button>
          <button id="next-btn" onclick="nextQuestion()">下一題</button>
        </div>
        <div id="feedback"></div>
        <button id="speak-btn" onclick="speakQuestionAndWord(q)">🔊 朗讀</button>
      `;
      const inputEl = document.getElementById('user-input');
      inputEl.focus();
      inputEl.onkeydown = function(e) {
        if (e.key === 'Enter') checkAnswer();
        else if (e.key.length === 1) { try { typeSound.currentTime = 0; typeSound.play(); } catch(e){} }
      };
      updateCounter();
      startTimer();
      setTimeout(() => {
        speak(q.original, 0.97);
      }, 400);
      document.getElementById('speak-btn').onclick = () => speakQuestionAndWord(q);
      // 記錄本題開始作答時間
      window.answerStartTime = Date.now();
      
      // 鎖定複習按鈕
      lockReviewButton();
    }

    function skipQuestion(){ stopTimer();
      answerLog[currentIndex] = {
        word: data[currentIndex].answer,
        zh: data[currentIndex].zh_sentence ? data[currentIndex].zh_sentence : data[currentIndex].zh,
        en: data[currentIndex].original,
        user: '',
        correct: null,
        stars: 0
      };
      const feedback = document.getElementById('feedback');
      if (feedback) feedback.innerHTML = `<span style='color:#bbb;'>已跳過本題</span>`;
      setTimeout(()=>{ currentIndex++; showQuestion(); }, 400);
    }

    function nextQuestion(){ stopTimer();
      if(!answerLog[currentIndex]){
        answerLog[currentIndex] = {
          word: data[currentIndex].answer,
          zh: data[currentIndex].zh_sentence ? data[currentIndex].zh_sentence : data[currentIndex].zh,
          en: data[currentIndex].original,
          user: document.getElementById('user-input')?.value || '',
          correct: false,
          stars: 0
        };
        const feedback = document.getElementById('feedback');
        if (feedback) feedback.innerHTML = `<span style='color:#bbb;'>未作答</span>`;
      }
      setTimeout(()=>{ currentIndex++; showQuestion(); }, 400);
    }

    // ===== 遊戲結束畫面 =====
    function showGameEndScreen() {
      // 計算統計數據
      const correctCount = answerLog.filter(log => log && log.correct === true).length;
      const wrongCount = answerLog.filter(log => log && log.correct === false).length;
      const totalStars = loadTotalStars();

      // 更新結束畫面數據
      document.getElementById('endSessionStars').textContent = sessionStars;
      document.getElementById('endCorrectCount').textContent = correctCount;
      document.getElementById('endWrongCount').textContent = wrongCount;
      document.getElementById('endTotalStars').textContent = totalStars;

      // 顯示結束畫面
      document.getElementById('gameEndModal').style.display = 'flex';
      
      // 停止計時器
      stopTimer();
      
      // 解鎖複習按鈕
      unlockReviewButton();
      
      // 播放完成音效
      try {
        correctSound.currentTime = 0;
        correctSound.play();
      } catch (e) {}
      showGameVictoryDialogue();
    }

    function restartGame() {
      // 隱藏結束畫面
      document.getElementById('gameEndModal').style.display = 'none';
      
      // 重置遊戲狀態
      currentIndex = 0;
      sessionStars = 0;
      answerLog = [];
      
      // 重新初始化數據
      initData();
      updateCounter();
      showQuestion();
      
      // 更新本次星星顯示
      document.getElementById('sessionStarsDisplay').textContent = '本次已獲得 0 顆星星';
    }

    // 每次進入自動重置進度
    localStorage.removeItem('fillIndex');

    // 初始化
    document.getElementById('totalStarsCount').textContent = 0;
    initData(); loadProgress(); updateCounter(); showQuestion();
    
    // 初始化時解鎖複習按鈕
    unlockReviewButton();

    // ===== 星星顯示功能 =====
    function loadTotalStars() {
      const v = localStorage.getItem('totalStars');
      return v !== null ? parseInt(v, 10) : 0;
    }
    function updateStarsDisplay() {
      document.getElementById('totalStarsCount').textContent = loadTotalStars();
    }
    // 頁面載入時顯示星星數
    document.addEventListener('DOMContentLoaded', updateStarsDisplay);

    // 初始化背景音樂
    document.addEventListener('DOMContentLoaded', initBackgroundMusic);

    // ===== 複習單字功能 =====
    function showReviewModal() {
      // 暫停遊戲計時器
      stopTimer();
      
      const container = document.getElementById('reviewWordsContainer');
      const categoryFilter = document.getElementById('categoryFilter');
      const totalVocabCount = document.getElementById('totalVocabCount');
      
      // 更新總數統計
      totalVocabCount.textContent = rawData.length;
      
      // 顯示所有單字
      displayVocabByCategory('all');
      
      // 添加分類篩選事件監聽器
      categoryFilter.onchange = function() {
        displayVocabByCategory(this.value);
      };
      
      document.getElementById('reviewModal').style.display = 'flex';
    }

    function displayVocabByCategory(category) {
      const container = document.getElementById('reviewWordsContainer');
      const totalVocabCount = document.getElementById('totalVocabCount');
      
      // 清空容器
      container.innerHTML = '';
      
      // 篩選單字
      let filteredVocab = rawData;
      if (category !== 'all') {
        filteredVocab = rawData.filter(item => item.category === category);
      }
      
      // 更新統計資訊
      totalVocabCount.textContent = filteredVocab.length;
      
      // 顯示分類標題
      if (category !== 'all') {
        const categoryTitle = document.createElement('div');
        categoryTitle.style.cssText = `
          color: #0ff;
          font-size: 1.3rem;
          font-weight: bold;
          margin: 15px 0 10px 0;
          padding: 10px;
          background: rgba(0, 255, 255, 0.1);
          border-radius: 8px;
          text-align: center;
        `;
        categoryTitle.textContent = `📂 ${category} (${filteredVocab.length}個單字)`;
        container.appendChild(categoryTitle);
      }
      
      // 顯示單字
      filteredVocab.forEach((item, index) => {
        const wordDiv = document.createElement('div');
        wordDiv.style.cssText = `
          background: rgba(255, 255, 255, 0.1);
          border: 1px solid #ffd700;
          border-radius: 10px;
          padding: 15px;
          margin: 10px 0;
          text-align: left;
          cursor: pointer;
          transition: all 0.3s;
        `;
        
        // 添加分類標籤
        const categoryLabel = category === 'all' ? `<span style="color: #0ff; font-size: 0.8rem; background: rgba(0,255,255,0.2); padding: 2px 6px; border-radius: 4px; margin-left: 8px;">${item.category}</span>` : '';
        
        wordDiv.innerHTML = `
          <div style="display: flex; align-items: flex-start; gap: 15px;">
            <div style="flex: 1; min-width: 0;">
              <div style="color: #ffd700; font-size: 1.2rem; font-weight: bold; margin-bottom: 8px; word-break: break-word;">
                ${index+1}. ${item.word}${categoryLabel}
              </div>
              <div style="color: #fff; font-size: 1rem; margin-bottom: 8px; word-break: break-word;">
                ${item.zh}
              </div>
              <div style="color: #0ff; font-size: 0.9rem; font-style: italic; word-break: break-word;">
                ${item.en_sentence}
              </div>
            </div>
            <button onclick="event.stopPropagation(); speakWord('${item.word}')" style="
              background: #0ff;
              color: #000;
              border: none;
              border-radius: 50%;
              width: 45px;
              height: 45px;
              font-size: 1.3rem;
              cursor: pointer;
              flex-shrink: 0;
              display: flex;
              align-items: center;
              justify-content: center;
              transition: all 0.2s;
              box-shadow: 0 2px 8px rgba(0,255,255,0.3);">🔊</button>
          </div>
        `;
        
        // 添加懸停效果
        wordDiv.addEventListener('mouseenter', () => {
          wordDiv.style.background = 'rgba(255, 215, 0, 0.2)';
          wordDiv.style.transform = 'scale(1.02)';
        });
        
        wordDiv.addEventListener('mouseleave', () => {
          wordDiv.style.background = 'rgba(255, 255, 255, 0.1)';
          wordDiv.style.transform = 'scale(1)';
        });
        
        wordDiv.addEventListener('click', () => {
          speakWord(item.word);
        });
        
        container.appendChild(wordDiv);
      });
      
      // 如果沒有單字，顯示提示
      if (filteredVocab.length === 0) {
        const noWordsDiv = document.createElement('div');
        noWordsDiv.style.cssText = `
          text-align: center;
          color: #888;
          font-size: 1.1rem;
          padding: 40px;
          font-style: italic;
        `;
        noWordsDiv.textContent = '此分類暫無單字';
        container.appendChild(noWordsDiv);
      }
    }

    function closeReviewModal() {
      document.getElementById('reviewModal').style.display = 'none';
      // 恢復遊戲計時器（如果遊戲還在進行中）
      if (currentIndex < data.length && !answered) {
        startTimer();
      }
    }

    function speakWord(word) {
      if (!window.speechSynthesis) return;
      
      const utter = new window.SpeechSynthesisUtterance(word);
      utter.lang = 'en-US';
      utter.rate = 0.9;
      utter.pitch = 1.1;
      if (preferredVoice) utter.voice = preferredVoice;
      
      window.speechSynthesis.cancel();
      window.speechSynthesis.speak(utter);
    }

    // ===== 複習按鈕鎖定功能 =====
    function lockReviewButton() {
      const reviewBtn = document.querySelector('.top-btns button[onclick*="showReviewModal"]');
      if (reviewBtn) {
        reviewBtn.disabled = true;
        reviewBtn.style.background = '#555';
        reviewBtn.style.color = '#888';
        reviewBtn.style.cursor = 'not-allowed';
        reviewBtn.title = '遊戲進行中，無法複習單字';
      }
    }

    function unlockReviewButton() {
      const reviewBtn = document.querySelector('.top-btns button[onclick*="showReviewModal"]');
      if (reviewBtn) {
        reviewBtn.disabled = false;
        reviewBtn.style.background = '#ffd700';
        reviewBtn.style.color = '#000';
        reviewBtn.style.cursor = 'pointer';
        reviewBtn.title = '複習單字';
      }
    }

    // ===== 字庫統計功能 =====
    function showVocabStats() {
      // 計算各分類的單字數量
      const categoryStats = {};
      rawData.forEach(item => {
        categoryStats[item.category] = (categoryStats[item.category] || 0) + 1;
      });
      
      // 創建統計彈窗
      const statsModal = document.createElement('div');
      statsModal.className = 'modal';
      statsModal.style.display = 'flex';
      statsModal.innerHTML = `
        <div class="modal-content" style="max-width: 600px;">
          <div class="end-icon">📊</div>
          <h2>字庫統計</h2>
          <div style="text-align: left; margin: 20px 0;">
            <h3 style="color: #ffd700; margin-bottom: 15px;">📈 分類統計</h3>
            ${Object.entries(categoryStats).map(([category, count]) => `
              <div style="
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 8px 0;
                border-bottom: 1px solid rgba(255, 215, 0, 0.3);
              ">
                <span style="color: #fff;">${category}</span>
                <span style="color: #0ff; font-weight: bold;">${count} 個單字</span>
              </div>
            `).join('')}
            <div style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              padding: 12px 0;
              border-top: 2px solid #ffd700;
              margin-top: 10px;
              font-weight: bold;
            ">
              <span style="color: #ffd700;">總計</span>
              <span style="color: #ffd700;">${rawData.length} 個單字</span>
            </div>
          </div>
          <div class="end-buttons">
            <button onclick="this.closest('.modal').remove()">關閉</button>
          </div>
        </div>
      `;
      
      // 添加點擊外部關閉功能
      statsModal.addEventListener('click', function(e) {
        if (e.target === statsModal) {
          statsModal.remove();
        }
      });
      
      document.body.appendChild(statsModal);
    }

    // ===== 字庫匯出功能 =====
    function exportVocabData() {
      // 創建CSV格式的數據
      const csvContent = [
        ['單字', '中文', '英文例句', '中文例句', '分類'],
        ...rawData.map(item => [
          item.word,
          item.zh,
          item.en_sentence,
          item.zh_sentence,
          item.category
        ])
      ].map(row => row.map(cell => `"${cell}"`).join(',')).join('\n');
      
      // 創建下載連結
      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      const url = URL.createObjectURL(blob);
      link.setAttribute('href', url);
      link.setAttribute('download', `hera_vocabulary_${new Date().toISOString().split('T')[0]}.csv`);
      link.style.visibility = 'hidden';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      // 顯示成功訊息
      showNotification('✅ 字庫已成功匯出！', 'success');
    }

    // ===== 通知功能 =====
    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: ${type === 'success' ? '#4caf50' : '#2196f3'};
        color: white;
        padding: 12px 24px;
        border-radius: 8px;
        font-weight: bold;
        z-index: 10000;
        animation: slideDown 0.3s ease-out;
      `;
      notification.textContent = message;
      
      // 添加動畫樣式
      const style = document.createElement('style');
      style.textContent = `
        @keyframes slideDown {
          from { transform: translateX(-50%) translateY(-100%); opacity: 0; }
          to { transform: translateX(-50%) translateY(0); opacity: 1; }
        }
      `;
      document.head.appendChild(style);
      
      document.body.appendChild(notification);
      
      // 3秒後自動移除
      setTimeout(() => {
        notification.remove();
        style.remove();
      }, 3000);
    }

    // 點擊彈窗外也能關閉
    document.addEventListener('DOMContentLoaded', function() {
      const reviewModal = document.getElementById('reviewModal');
      const gameEndModal = document.getElementById('gameEndModal');
      
      if(reviewModal){
        reviewModal.addEventListener('click', function(e){
          if(e.target === reviewModal){
            closeReviewModal();
          }
        });
      }
      
      if(gameEndModal){
        gameEndModal.addEventListener('click', function(e){
          if(e.target === gameEndModal){
            document.getElementById('gameEndModal').style.display = 'none';
          }
        });
      }
    });

    // 角色互動系統整合
    let currentCharacter = localStorage.getItem('characterName') || 'zeus';
    if (window.GameDialogue) {
      window.GameDialogue.currentCharacter = currentCharacter;
    }
    function showGameStartDialogue() {
      if (window.GameDialogue) {
        window.GameDialogue.showGameStartDialogue();
      }
    }
    function showCorrectAnswerDialogue() {
      if (window.GameDialogue) {
        window.GameDialogue.showCorrectAnswerDialogue();
      }
    }
    function showWrongAnswerDialogue() {
      if (window.GameDialogue) {
        window.GameDialogue.showWrongAnswerDialogue();
      }
    }
    function showGameVictoryDialogue() {
      if (window.GameDialogue) {
        window.GameDialogue.showGameVictoryDialogue();
      }
    }
    function showGameDefeatDialogue() {
      if (window.GameDialogue) {
        window.GameDialogue.showGameDefeatDialogue();
      }
    }
    // 在遊戲初始化時觸發開始對話
    window.addEventListener('DOMContentLoaded', function() {
      if (window.GameDialogue) {
        window.GameDialogue.init();
        showGameStartDialogue();
      }
    });
  </script>
</body>
</html>